<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Overleaf å¤‡ä»½ç®¡ç†ç³»ç»Ÿ</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      border-radius: 16px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      overflow: hidden;
    }
    
    .header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 30px;
      text-align: center;
    }
    
    .header h1 {
      font-size: 28px;
      margin-bottom: 10px;
    }
    
    .stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-top: 20px;
    }
    
    .stat-card {
      background: rgba(255,255,255,0.2);
      padding: 15px;
      border-radius: 8px;
      text-align: center;
    }
    
    .stat-value {
      font-size: 24px;
      font-weight: bold;
      margin-bottom: 5px;
    }
    
    .stat-label {
      font-size: 12px;
      opacity: 0.9;
    }
    
    .content {
      padding: 30px;
    }
    
    .tabs {
      display: flex;
      gap: 10px;
      margin-bottom: 30px;
      border-bottom: 2px solid #e0e0e0;
    }
    
    .tab {
      padding: 12px 24px;
      background: none;
      border: none;
      border-bottom: 3px solid transparent;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      color: #666;
      transition: all 0.3s;
    }
    
    .tab.active {
      color: #667eea;
      border-bottom-color: #667eea;
    }
    
    .tab:hover {
      color: #667eea;
    }
    
    .tab-content {
      display: none;
    }
    
    .tab-content.active {
      display: block;
    }
    
    .section {
      margin-bottom: 40px;
    }
    
    .section h2 {
      color: #333;
      margin-bottom: 20px;
      padding-bottom: 10px;
      border-bottom: 2px solid #667eea;
    }
    
    .form-group {
      margin-bottom: 20px;
    }
    
    label {
      display: block;
      margin-bottom: 8px;
      color: #555;
      font-weight: 500;
    }
    
    input[type="text"],
    input[type="password"],
    input[type="number"],
    textarea {
      width: 100%;
      padding: 12px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: 14px;
      transition: border-color 0.3s;
    }
    
    input[type="text"]:focus,
    input[type="password"]:focus,
    input[type="number"]:focus,
    textarea:focus {
      outline: none;
      border-color: #667eea;
    }
    
    input[type="checkbox"] {
      width: 20px;
      height: 20px;
      cursor: pointer;
    }
    
    .checkbox-group {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    small {
      display: block;
      margin-top: 5px;
      color: #666;
      font-size: 12px;
    }
    
    .btn {
      padding: 12px 24px;
      border: none;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s;
      margin-right: 10px;
      margin-bottom: 10px;
    }
    
    .btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    
    .btn-primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }
    
    .btn-primary:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
    }
    
    .btn-success {
      background: #28a745;
      color: white;
    }
    
    .btn-success:hover:not(:disabled) {
      background: #218838;
    }
    
    .btn-danger {
      background: #dc3545;
      color: white;
    }
    
    .btn-danger:hover:not(:disabled) {
      background: #c82333;
    }
    
    .project-list {
      display: grid;
      gap: 15px;
    }
    
    .project-item {
      background: #f8f9fa;
      padding: 20px;
      border-radius: 8px;
      border: 2px solid #e0e0e0;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .project-info {
      flex: 1;
    }
    
    .project-name {
      font-weight: 600;
      color: #333;
      margin-bottom: 5px;
    }
    
    .project-id {
      color: #666;
      font-size: 12px;
      font-family: monospace;
    }
    
    .project-actions {
      display: flex;
      gap: 10px;
    }
    
    .status {
      display: inline-block;
      padding: 4px 12px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 500;
      margin-right: 10px;
    }
    
    .status.enabled {
      background: #d4edda;
      color: #155724;
    }
    
    .status.disabled {
      background: #f8d7da;
      color: #721c24;
    }
    
    .message {
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
      display: none;
    }
    
    .message.success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }
    
    .message.error {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }
    
    .message.info {
      background: #d1ecf1;
      color: #0c5460;
      border: 1px solid #bee5eb;
    }
    
    .add-project-form {
      background: #f8f9fa;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 20px;
    }
    
    .backup-output {
      background: #1e1e1e;
      color: #d4d4d4;
      padding: 15px;
      border-radius: 8px;
      font-family: 'Courier New', monospace;
      font-size: 12px;
      max-height: 400px;
      overflow-y: auto;
      white-space: pre-wrap;
      word-wrap: break-word;
      margin-top: 15px;
      display: none;
    }
    
    .grid-2 {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }
    
    .grid-3 {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 20px;
    }
    
    .config-card {
      background: #f8f9fa;
      padding: 20px;
      border-radius: 8px;
      border: 2px solid #e0e0e0;
    }
    
    .config-card h3 {
      color: #333;
      margin-bottom: 15px;
      font-size: 16px;
    }
    
    @media (max-width: 768px) {
      .grid-2, .grid-3 {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>ğŸ—‚ï¸ Overleaf å¤‡ä»½ç®¡ç†ç³»ç»Ÿ</h1>
      <p>ç®¡ç†å¤šä¸ª Overleaf é¡¹ç›®çš„è‡ªåŠ¨å¤‡ä»½</p>
      <div class="stats" id="stats">
        <!-- ç»Ÿè®¡æ•°æ®å°†åœ¨è¿™é‡ŒåŠ¨æ€åŠ è½½ -->
      </div>
    </div>
    
    <div class="content">
      <div id="message" class="message"></div>
      
      <!-- æ ‡ç­¾é¡µ -->
      <div class="tabs">
        <button class="tab active" onclick="switchTab('projects')">ğŸ“‹ é¡¹ç›®ç®¡ç†</button>
        <button class="tab" onclick="switchTab('backup')">ğŸš€ å¤‡ä»½</button>
        <button class="tab" onclick="switchTab('settings')">âš™ï¸ è®¾ç½®</button>
      </div>
      
      <!-- é¡¹ç›®ç®¡ç†æ ‡ç­¾é¡µ -->
      <div id="tab-projects" class="tab-content active">
        <!-- æ·»åŠ é¡¹ç›® -->
        <div class="section">
          <h2>â• æ·»åŠ æ–°é¡¹ç›®</h2>
          <div class="add-project-form">
            <div class="form-group">
              <label>é¡¹ç›® ID</label>
              <input type="text" id="new_project_id" placeholder="697f752d1b7f3f586b45ed5e">
              <small>ä»é¡¹ç›® URL ä¸­è·å–ï¼Œä¾‹å¦‚: overleaf.com/project/<strong>697f752d1b7f3f586b45ed5e</strong></small>
            </div>
            <div class="form-group">
              <label>é¡¹ç›®åç§°</label>
              <input type="text" id="new_project_name" placeholder="æˆ‘çš„è®ºæ–‡">
            </div>
            <button class="btn btn-primary" onclick="addProject()">æ·»åŠ é¡¹ç›®</button>
          </div>
        </div>
        
        <!-- é¡¹ç›®åˆ—è¡¨ -->
        <div class="section">
          <h2>ğŸ“‹ é¡¹ç›®åˆ—è¡¨</h2>
          <div id="project-list" class="project-list">
            <!-- é¡¹ç›®å°†åœ¨è¿™é‡ŒåŠ¨æ€åŠ è½½ -->
          </div>
        </div>
      </div>
      
      <!-- å¤‡ä»½æ ‡ç­¾é¡µ -->
      <div id="tab-backup" class="tab-content">
        <div class="section">
          <h2>ğŸš€ æ‰‹åŠ¨æ‰§è¡Œå¤‡ä»½</h2>
          <p style="margin-bottom: 20px; color: #666;">ç«‹å³å¤‡ä»½æ‰€æœ‰å¯ç”¨çš„é¡¹ç›®</p>
          <button class="btn btn-success" id="backup-btn" onclick="runBackup()">ç«‹å³æ‰§è¡Œå¤‡ä»½</button>
          <div id="backup-output" class="backup-output"></div>
        </div>
      </div>
      
      <!-- è®¾ç½®æ ‡ç­¾é¡µ -->
      <div id="tab-settings" class="tab-content">
        
        <!-- å¤‡ä»½é…ç½® -->
        <div class="section">
          <h2>ğŸ“¦ å¤‡ä»½é…ç½®</h2>
          <div class="config-card">
            <div class="grid-2">
              <div class="form-group">
                <label>Overleaf URL</label>
                <input type="text" id="overleaf_url" placeholder="https://overleaf.boydream.work">
                <small>ä½ çš„ Overleaf æœåŠ¡å™¨åœ°å€</small>
              </div>
              <div class="form-group">
                <label>å¤‡ä»½ç›®å½•</label>
                <input type="text" id="backup_dir" placeholder="./Backup">
                <small>å¤‡ä»½æ–‡ä»¶å­˜å‚¨è·¯å¾„</small>
              </div>
            </div>
            <div class="form-group">
              <label>Cookieï¼ˆç”¨äºèº«ä»½éªŒè¯ï¼‰</label>
              <input type="password" id="cookie" placeholder="ç²˜è´´ä½ çš„ Cookie">
              <small>ä»æµè§ˆå™¨å¼€å‘è€…å·¥å…·ä¸­è·å–ï¼Œç”¨äºä¸‹è½½é¡¹ç›®æ–‡ä»¶</small>
            </div>
            <div class="grid-3">
              <div class="form-group">
                <label>ä¿ç•™å¤‡ä»½æ•°é‡</label>
                <input type="number" id="keep_last" placeholder="5" value="5" min="1" max="100">
                <small>æ¯ä¸ªé¡¹ç›®ä¿ç•™æœ€è¿‘ N ä¸ªå¤‡ä»½</small>
              </div>
              <div class="form-group">
                <label>è‡ªåŠ¨å¤‡ä»½é—´éš”ï¼ˆåˆ†é’Ÿï¼‰</label>
                <input type="number" id="backup_interval" placeholder="15" value="15" min="1" max="1440">
                <small>å®šæ—¶å¤‡ä»½çš„æ—¶é—´é—´éš”</small>
              </div>
              <div class="form-group">
                <label>è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰</label>
                <input type="number" id="timeout" placeholder="300" value="300" min="30" max="3600">
                <small>å•ä¸ªé¡¹ç›®ä¸‹è½½è¶…æ—¶</small>
              </div>
            </div>
            <div class="form-group">
              <div class="checkbox-group">
                <input type="checkbox" id="auto_backup">
                <label for="auto_backup" style="margin: 0;">å¯ç”¨è‡ªåŠ¨å¤‡ä»½</label>
              </div>
              <small>å‹¾é€‰åå°†æŒ‰ç…§è®¾å®šçš„é—´éš”è‡ªåŠ¨æ‰§è¡Œå¤‡ä»½ï¼ˆéœ€é‡å¯æœåŠ¡ï¼‰</small>
            </div>
            <button class="btn btn-success" onclick="saveBackupConfig()">ğŸ’¾ ä¿å­˜å¤‡ä»½é…ç½®</button>
          </div>
        </div>
        
        <!-- æœåŠ¡å™¨é…ç½® -->
        <div class="section">
          <h2>ğŸ–¥ï¸ æœåŠ¡å™¨é…ç½®</h2>
          <div class="config-card">
            <div class="grid-3">
              <div class="form-group">
                <label>ç›‘å¬åœ°å€</label>
                <input type="text" id="server_host" placeholder="0.0.0.0" value="0.0.0.0">
                <small>0.0.0.0 å…è®¸å¤–éƒ¨è®¿é—®</small>
              </div>
              <div class="form-group">
                <label>ç«¯å£</label>
                <input type="number" id="server_port" placeholder="5000" value="5000" min="1" max="65535">
                <small>Web æœåŠ¡ç›‘å¬ç«¯å£</small>
              </div>
              <div class="form-group">
                <label style="opacity: 0;">å ä½</label>
                <div class="checkbox-group" style="margin-top: 12px;">
                  <input type="checkbox" id="server_debug">
                  <label for="server_debug" style="margin: 0;">è°ƒè¯•æ¨¡å¼</label>
                </div>
                <small>å¯ç”¨åæ˜¾ç¤ºè¯¦ç»†é”™è¯¯ä¿¡æ¯</small>
              </div>
            </div>
            <button class="btn btn-success" onclick="saveServerConfig()">ğŸ’¾ ä¿å­˜æœåŠ¡å™¨é…ç½®</button>
            <small style="color: #dc3545; margin-top: 10px;">âš ï¸ ä¿®æ”¹æœåŠ¡å™¨é…ç½®åéœ€è¦æ‰‹åŠ¨é‡å¯æœåŠ¡æ‰èƒ½ç”Ÿæ•ˆ</small>
          </div>
        </div>
        
      </div>
      
    </div>
  </div>

  <script>
    let currentTab = 'projects';
    
    // åˆ‡æ¢æ ‡ç­¾é¡µ
    function switchTab(tabName) {
      // éšè—æ‰€æœ‰æ ‡ç­¾å†…å®¹
      document.querySelectorAll('.tab-content').forEach(el => {
        el.classList.remove('active');
      });
      
      // ç§»é™¤æ‰€æœ‰æ ‡ç­¾çš„æ¿€æ´»çŠ¶æ€
      document.querySelectorAll('.tab').forEach(el => {
        el.classList.remove('active');
      });
      
      // æ˜¾ç¤ºé€‰ä¸­çš„æ ‡ç­¾å†…å®¹
      document.getElementById('tab-' + tabName).classList.add('active');
      
      // æ¿€æ´»é€‰ä¸­çš„æ ‡ç­¾
      event.target.classList.add('active');
      
      currentTab = tabName;
    }
    
    // åŠ è½½ç»Ÿè®¡æ•°æ®
    function loadStats() {
      fetch('/api/status')
        .then(res => res.json())
        .then(data => {
          document.getElementById('stats').innerHTML = `
            <div class="stat-card">
              <div class="stat-value">${data.total_projects}</div>
              <div class="stat-label">æ€»é¡¹ç›®æ•°</div>
            </div>
            <div class="stat-card">
              <div class="stat-value">${data.enabled_projects}</div>
              <div class="stat-label">å¯ç”¨é¡¹ç›®</div>
            </div>
            <div class="stat-card">
              <div class="stat-value">${data.total_backup_files}</div>
              <div class="stat-label">å¤‡ä»½æ–‡ä»¶</div>
            </div>
            <div class="stat-card">
              <div class="stat-value">${data.total_backup_size_human}</div>
              <div class="stat-label">æ€»å¤‡ä»½å¤§å°</div>
            </div>
          `;
        })
        .catch(err => console.error('åŠ è½½ç»Ÿè®¡æ•°æ®å¤±è´¥:', err));
    }
    
    // åŠ è½½é…ç½®
    function loadConfig() {
      fetch('/api/config')
        .then(res => res.json())
        .then(data => {
          // å¤‡ä»½é…ç½®
          document.getElementById('overleaf_url').value = data.backup.overleaf_url || '';
          document.getElementById('backup_dir').value = data.backup.backup_dir || './Backup';
          document.getElementById('cookie').value = data.backup.cookie || '';
          document.getElementById('keep_last').value = data.backup.keep_last || 5;
          document.getElementById('backup_interval').value = data.backup.backup_interval || 15;
          document.getElementById('timeout').value = data.backup.timeout || 300;
          document.getElementById('auto_backup').checked = data.backup.auto_backup || false;
          
          // æœåŠ¡å™¨é…ç½®
          document.getElementById('server_host').value = data.server.host || '0.0.0.0';
          document.getElementById('server_port').value = data.server.port || 5000;
          document.getElementById('server_debug').checked = data.server.debug || false;
          
          // é¡¹ç›®åˆ—è¡¨
          renderProjects(data.projects || []);
        })
        .catch(err => showMessage('åŠ è½½é…ç½®å¤±è´¥: ' + err.message, 'error'));
    }
    
    // æ¸²æŸ“é¡¹ç›®åˆ—è¡¨
    function renderProjects(projects) {
      const container = document.getElementById('project-list');
      if (projects.length === 0) {
        container.innerHTML = '<p style="color: #999; text-align: center; padding: 40px;">æš‚æ— é¡¹ç›®ï¼Œè¯·æ·»åŠ æ–°é¡¹ç›®</p>';
        return;
      }
      
      container.innerHTML = projects.map((project, index) => `
        <div class="project-item">
          <div class="project-info">
            <div class="project-name">
              <span class="status ${project.enabled ? 'enabled' : 'disabled'}">
                ${project.enabled ? 'âœ“ å·²å¯ç”¨' : 'âœ— å·²ç¦ç”¨'}
              </span>
              ${project.name}
            </div>
            <div class="project-id">ID: ${project.id}</div>
          </div>
          <div class="project-actions">
            <button class="btn btn-primary" onclick="toggleProject(${index})">
              ${project.enabled ? 'ç¦ç”¨' : 'å¯ç”¨'}
            </button>
            <button class="btn btn-danger" onclick="deleteProject(${index})">åˆ é™¤</button>
          </div>
        </div>
      `).join('');
    }
    
    // ä¿å­˜å¤‡ä»½é…ç½®
    function saveBackupConfig() {
      const config = {
        overleaf_url: document.getElementById('overleaf_url').value,
        backup_dir: document.getElementById('backup_dir').value,
        cookie: document.getElementById('cookie').value,
        keep_last: parseInt(document.getElementById('keep_last').value) || 5,
        backup_interval: parseInt(document.getElementById('backup_interval').value) || 15,
        timeout: parseInt(document.getElementById('timeout').value) || 300,
        auto_backup: document.getElementById('auto_backup').checked
      };
      
      fetch('/api/config/backup', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(config)
      })
      .then(res => res.json())
      .then(data => {
        showMessage(data.message || 'å¤‡ä»½é…ç½®ä¿å­˜æˆåŠŸï¼', 'success');
        loadStats();
      })
      .catch(err => showMessage('ä¿å­˜å¤±è´¥: ' + err.message, 'error'));
    }
    
    // ä¿å­˜æœåŠ¡å™¨é…ç½®
    function saveServerConfig() {
      const config = {
        host: document.getElementById('server_host').value,
        port: parseInt(document.getElementById('server_port').value) || 5000,
        debug: document.getElementById('server_debug').checked
      };
      
      fetch('/api/config/server', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(config)
      })
      .then(res => res.json())
      .then(data => {
        showMessage(data.message || 'æœåŠ¡å™¨é…ç½®ä¿å­˜æˆåŠŸï¼éœ€è¦é‡å¯æœåŠ¡ç”Ÿæ•ˆã€‚', 'success');
      })
      .catch(err => showMessage('ä¿å­˜å¤±è´¥: ' + err.message, 'error'));
    }
    
    // æ·»åŠ é¡¹ç›®
    function addProject() {
      const id = document.getElementById('new_project_id').value.trim();
      const name = document.getElementById('new_project_name').value.trim();
      
      if (!id || !name) {
        showMessage('è¯·å¡«å†™é¡¹ç›® ID å’Œåç§°', 'error');
        return;
      }
      
      fetch('/api/projects', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ id, name, enabled: true })
      })
      .then(res => res.json())
      .then(data => {
        if (data.success) {
          showMessage(data.message || 'é¡¹ç›®æ·»åŠ æˆåŠŸï¼', 'success');
          document.getElementById('new_project_id').value = '';
          document.getElementById('new_project_name').value = '';
          loadConfig();
          loadStats();
        } else {
          showMessage('æ·»åŠ å¤±è´¥: ' + data.error, 'error');
        }
      })
      .catch(err => showMessage('æ·»åŠ å¤±è´¥: ' + err.message, 'error'));
    }
    
    // åˆ‡æ¢é¡¹ç›®å¯ç”¨çŠ¶æ€
    function toggleProject(index) {
      fetch(`/api/projects/${index}/toggle`, { method: 'POST' })
        .then(res => res.json())
        .then(data => {
          showMessage(data.message || 'çŠ¶æ€æ›´æ–°æˆåŠŸï¼', 'success');
          loadConfig();
          loadStats();
        })
        .catch(err => showMessage('æ›´æ–°å¤±è´¥: ' + err.message, 'error'));
    }
    
    // åˆ é™¤é¡¹ç›®
    function deleteProject(index) {
      if (!confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªé¡¹ç›®å—ï¼Ÿå¤‡ä»½æ–‡ä»¶ä¸ä¼šè¢«åˆ é™¤ã€‚')) return;
      
      fetch(`/api/projects/${index}`, { method: 'DELETE' })
        .then(res => res.json())
        .then(data => {
          showMessage(data.message || 'é¡¹ç›®åˆ é™¤æˆåŠŸï¼', 'success');
          loadConfig();
          loadStats();
        })
        .catch(err => showMessage('åˆ é™¤å¤±è´¥: ' + err.message, 'error'));
    }
    
    // æ‰§è¡Œå¤‡ä»½
    function runBackup() {
      const btn = document.getElementById('backup-btn');
      const output = document.getElementById('backup-output');
      
      btn.disabled = true;
      btn.textContent = 'æ­£åœ¨å¤‡ä»½...';
      output.style.display = 'block';
      output.textContent = 'æ­£åœ¨æ‰§è¡Œå¤‡ä»½ï¼Œè¯·ç¨å€™...\n';
      
      showMessage('æ­£åœ¨æ‰§è¡Œå¤‡ä»½ï¼Œè¯·ç¨å€™...', 'info');
      
      fetch('/api/backup', { method: 'POST' })
        .then(res => res.json())
        .then(data => {
          btn.disabled = false;
          btn.textContent = 'ç«‹å³æ‰§è¡Œå¤‡ä»½';
          
          if (data.success) {
            showMessage('å¤‡ä»½æ‰§è¡Œå®Œæˆï¼', 'success');
            output.textContent = data.output;
            loadStats();
          } else {
            showMessage('å¤‡ä»½å¤±è´¥: ' + data.error, 'error');
            output.textContent = 'é”™è¯¯ä¿¡æ¯:\n' + data.error + '\n\nè¾“å‡º:\n' + data.output;
          }
        })
        .catch(err => {
          btn.disabled = false;
          btn.textContent = 'ç«‹å³æ‰§è¡Œå¤‡ä»½';
          showMessage('å¤‡ä»½å¤±è´¥: ' + err.message, 'error');
          output.textContent = 'ç½‘ç»œé”™è¯¯: ' + err.message;
        });
    }
    
    // æ˜¾ç¤ºæ¶ˆæ¯
    function showMessage(text, type) {
      const msg = document.getElementById('message');
      msg.textContent = text;
      msg.className = 'message ' + type;
      msg.style.display = 'block';
      setTimeout(() => { msg.style.display = 'none'; }, 5000);
    }
    
    // é¡µé¢åŠ è½½æ—¶è¯»å–é…ç½®å’Œç»Ÿè®¡
    loadConfig();
    loadStats();
    
    // æ¯ 30 ç§’åˆ·æ–°ä¸€æ¬¡ç»Ÿè®¡æ•°æ®
    setInterval(loadStats, 30000);
  </script>
</body>
</html>